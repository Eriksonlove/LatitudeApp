<!doctype html>
<html class="no-js " lang="pt">

<head>
    <% include ../views/layout/head %>
</head>

<body id="falcon" class="main_Wrapper">
    <div id="wrap" class="animsition">
        <% include ../views/layout/header %>
            <!--  CONTROLS Content  -->
            <div id="controls">
                <!--SIDEBAR Content -->
                <aside id="leftmenu">
                    <div id="leftmenu-wrap">
                        <div class="panel-group slim-scroll" role="tablist">
                            <div class="panel panel-default">
                                <div id="leftmenuNav" class="panel-collapse collapse in" role="tabpanel">
                                    <div class="panel-body">
                                        <!--  NAVIGATION Content -->
                                        <ul id="navigation">
                                            <li>
                                                <a href="">
                                                    <i class="fa fa-dashboard"></i>
                                                    <span>Inicio</span>
                                                </a>
                                            </li>
                                            <li class="active">
                                                <a href="material.html">
                                                    <i class="fa fa-arrow-right"></i>
                                                    <span>Material UI</span>
                                                </a>
                                            </li>
                                            <li>
                                                <a role="button" tabindex="0">
                                                    <i class="fa fa-leaf"></i>
                                                    <span>Falcon UI</span>
                                                </a>
                                                <ul>
                                                    <li>
                                                        <a href="ui-general.html">
                                                            <i class="fa fa-angle-right"></i>General Elements</a>
                                                    </li>
                                                    <li>
                                                        <a href="ui-navigation.html">
                                                            <i class="fa fa-angle-right"></i>Nav & Accordions</a>
                                                    </li>
                                                    <li>
                                                        <a href="ui-widgets.html">
                                                            <i class="fa fa-angle-right"></i>Widgets</a>
                                                    </li>
                                                    <li>
                                                        <a href="ui-boxss.html">
                                                            <i class="fa fa-angle-right"></i>boxss</a>
                                                    </li>
                                                    <li>
                                                        <a href="ui-portlets.html">
                                                            <i class="fa fa-angle-right"></i>Portlets</a>
                                                    </li>
                                                </ul>
                                            </li>
                                            <li>
                                                <a href="charts.html">
                                                    <i class="fa fa-bar-chart-o"></i>
                                                    <span>Charts</span>
                                                </a>
                                            </li>
                                        </ul>
                                        <!--/ NAVIGATION Content -->
                                    </div>
                                </div>
                            </div>
                            <div class="panel settings panel-default">
                                <div class="panel-heading" role="tab">
                                    <h4 class="panel-title">
                                        <a data-toggle="collapse" href="#leftmenuControls">General Settings
                                            <i class="fa fa-angle-up"></i>
                                        </a>
                                    </h4>
                                </div>
                                <div id="leftmenuControls" class="panel-collapse collapse in" role="tabpanel">
                                    <div class="panel-body">
                                        <% servicos.forEach(function(serv) { %>
                                            <div class="form-group">
                                                <div class="row">
                                                    <label class="col-xs-8">
                                                        <i class="<%=serv.icon%>"></i>&nbsp;
                                                        <%=serv.nome%>
                                                    </label>
                                                    <div class="col-xs-4 control-label">
                                                        <div class="togglebutton">
                                                            <label>
                                                                <input type="checkbox" checked="">
                                                            </label>
                                                        </div>
                                                    </div>
                                                </div>
                                            </div>
                                            <% }); %>
                                                <!--<div class="form-group">
                                                    <div class="row">
                                                        <label class="col-xs-8">Switch OFF</label>
                                                        <div class="col-xs-4 control-label">
                                                            <div class="togglebutton">
                                                                <label>
                                                                    <input type="checkbox">
                                                                </label>
                                                            </div>
                                                        </div>
                                                    </div>
                                                </div>
                                                -->
                                    </div>
                                </div>
                                <div class="milestone-sidbar">
                                    <div class="text-center-folded">
                                        <span class="pull-right pull-none-folded">60%</span>
                                        <span class="hidden-folded">Milestone</span>
                                    </div>
                                    <div class="progress progress-xxs m-t-sm dk">
                                        <div class="progress-bar progress-bar-info" style="width: 60%;"> </div>
                                    </div>
                                    <div class="text-center-folded">
                                        <span class="pull-right pull-none-folded">35%</span>
                                        <span class="hidden-folded">Release</span>
                                    </div>
                                    <div class="progress progress-xxs m-t-sm dk">
                                        <div class="progress-bar progress-bar-primary" style="width: 35%;"> </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </aside>
                <!--/ SIDEBAR Content -->
            </div>
            <!--/ CONTROLS Content -->

            <!-- CONTENT  -->
            <section id="content">
                <div class="page page-ui-boxss">
                    <!-- bradcome -->
                    <div class="b-b mb-10">
                        <div class="row">
                            <div class="col-sm-6 col-xs-12">
                                <h3 class="h3 m-0">
                                    <%=titulo%>
                                </h3>
                                <small class="text-muted">
                                    <%=subtitulo%>
                                </small>
                            </div>
                        </div>
                    </div>
                    <div class="row">
                        <div class="col-md-6">
                            <section class="boxs">
                                <div class="boxs-body">
                                    <!-- right side header -->
                                    <div class="row">
                                        <div class="col-md-12">
                                            <h3 class="m-0 mr-5 inline-block">Erikson Melgarejo</h3>
                                        </div>
                                    </div>
                                    <!-- /right side header -->
                                    <!-- chats -->
                                    <ul class="chats">
                                        <!--
                                            <li class="in">
                                            <div class="media">
                                                <div class="pull-left thumb thumb-sm">
                                                    <img class="media-object br-50" src="assets/images/random-avatar1.jpg" alt=""> </div>
                                                <div class="media-body">
                                                    <p class="media-heading">
                                                        <span class="datetime">2 hours ago</span>
                                                    </p>
                                                    <span class="body">psum available</span>
                                                </div>
                                            </div>
                                        </li>
                                        <li class="out">
                                            <div class="media">
                                                <div class="pull-right thumb thumb-sm">
                                                    <img class="media-object br-50" src="assets/images/profile-photo.jpg" alt=""> </div>
                                                <div class="media-body">
                                                    <p class="media-heading">
                                                        <span class="datetime">2 hours ago</span>
                                                    </p>
                                                    <span class="body">Hi,</span>
                                                </div>
                                            </div>
                                        </li>
                                        -->
                                        <li v-bind:class="m.inbound ? 'in' : 'out'" v-for="m in mensagens">
                                            <div class="media">
                                                <div class="thumb thumb-sm" v-bind:class="m.inbound ? 'pull-left' : 'pull-right'">
                                                    <img class="media-object br-50" src="assets/images/random-avatar1.jpg" alt=""> </div>
                                                <!--<i class="fa fa-user-circle"></i>-->
                                                <div class="media-body">
                                                    <p class="media-heading">
                                                        <span class="datetime">{{m.dataChegada}}</span>
                                                    </p>
                                                    <span class="body">{{m.texto}}</span>
                                                </div>
                                            </div>
                                        </li>
                                    </ul>
                                    <div class="media">
                                        <div class="media-body">
                                            <div class="text-right">
                                                <div class="form-group is-empty">
                                                    <input type="text" value="" placeholder="Message" class="form-control" v-model="textoMsg">
                                                    <span class="material-input"></span>
                                                </div>
                                                <a href="#" class="p-10">
                                                    <i class="fa fa-trash-o"></i>
                                                </a>
                                                <button class="btn btn-raised btn-success" v-on:click="enviarMensagem">
                                                    <i class="fa fa-envelope"></i> Enviar
                                                </button>
                                            </div>
                                        </div>
                                    </div>
                                    <!-- / chats -->
                                </div>
                            </section>
                        </div>

                    </div>
                </div>
            </section>
    </div>
    <% include ../views/layout/js %>

        <script src="/socket.io/socket.io.js"></script>
        <script>
            var socket = io();
        </script>
        <script>
            var app = new Vue({
                el: '#wrap',
                data: {
                    interacao: {
                        contact: '244929164344',
                        name: 'Erikson Melgarejo'
                    },
                    mensagens: [],
                    textoMsg: ''
                },
                methods: {
                    adicionarMensagem: function (msg) {
                        var self = this;

                        self.mensagens.push(msg);
                    },
                    enviarMensagem: function () {
                        var self = this;

                        socket.emit('enviarMsg', {
                            contact: self.interacao.contact,
                            texto: self.textoMsg
                        });

                        self.textoMsg = '';
                    }
                },
                filters: {
                    json: function (value) {
                        return JSON.stringify(value, null, 2);
                    }
                }
            })
        </script>
        <script>
            (function () { socket.on('post', (data) => { app.cargar(data); }) }());

            (function () {
                socket.on('mensagem', (data) => {
                    console.log(data);

                    app.adicionarMensagem(data);
                })
            }());
        </script>
</body>